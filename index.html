<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœŸæœ«æˆ°æƒ…å®¤ // Final Quest V2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding-top: 50px; }
        .main-card { border-radius: 15px; border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .completed-text { text-decoration: line-through; color: #adb5bd; }
    </style>
</head>
<body>

    <div id="app" class="container">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <h1 class="text-center mb-4 fw-bold">ğŸ æœŸæœ«å…¨æ”»ç•¥æˆ°æƒ…å®¤</h1>
                
                <div class="card main-card p-4 mb-4">
                    <h5 class="mb-3">ç•¶å‰ç¸½é€²åº¦ï¼š{{ progress }}%</h5>
                    <div class="progress mb-4" style="height: 20px;">
                        <div class="progress-bar bg-success progress-bar-striped progress-bar-animated" 
                             :style="{ width: progress + '%' }"></div>
                    </div>

                    <div class="input-group mb-3">
                        <input type="text" v-model="newTask" @keyup.enter="addTask" class="form-control" placeholder="æ–°å¢æœŸæœ«ä»»å‹™...">
                        <button class="btn btn-primary" @click="addTask">æ–°å¢</button>
                    </div>

                    <ul class="list-group">
                        <li v-for="(task, index) in tasks" :key="index" class="list-group-item d-flex justify-content-between align-items-center">
                            <div @click="toggleTask(index)" style="cursor: pointer; flex-grow: 1;">
                                <input type="checkbox" v-model="task.done" class="me-2">
                                <span :class="{ 'completed-text': task.done }">{{ task.content }}</span>
                            </div>
                            <button class="btn btn-sm btn-outline-danger" @click="removeTask(index)">ğŸ—‘ï¸</button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
        const { createApp, ref, computed, watch } = Vue;
        createApp({
            setup() {
                const newTask = ref('');
                // å¾ LocalStorage è¼‰å…¥è³‡æ–™ (èª²ç¶±: JSON èˆ‡ API æ‡‰ç”¨æ¦‚å¿µ)
                const tasks = ref(JSON.parse(localStorage.getItem('final-tasks-v2') || '[]'));

                const addTask = () => {
                    if (newTask.value.trim()) {
                        tasks.value.push({ content: newTask.value, done: false });
                        newTask.value = '';
                    }
                };

                const toggleTask = (index) => {
                    tasks.value[index].done = !tasks.value[index].done;
                };

                const removeTask = (index) => {
                    tasks.value.splice(index, 1);
                };

                // è¨ˆç®—ç™¾åˆ†æ¯” (èª²ç¶± 10)
                const progress = computed(() => {
                    if (tasks.value.length === 0) return 0;
                    const doneCount = tasks.value.filter(t => t.done).length;
                    return Math.round((doneCount / tasks.value.length) * 100);
                });

                // ç›£è½ tasks è®ŠåŒ–ä¸¦å­˜æª”
                watch(tasks, (newVal) => {
                    localStorage.setItem('final-tasks-v2', JSON.stringify(newVal));
                }, { deep: true });

                return { newTask, tasks, addTask, removeTask, toggleTask, progress };
            }
        }).mount('#app');
    </script>
</body>
</html>